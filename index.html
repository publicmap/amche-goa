<!DOCTYPE html>
<html lang="en">

<head>

    <title>amche.in - Free Maps of Goa</title>
    <link rel="canonical" href="https://amche.in" />
    <link rel="manifest" href="/manifest.json">

    <!-- Favicon -->
    <link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/assets/img/icon-192x192.png">

    <!-- 
    
    SEO and Social Media Meta Tags
    Customize this to ensure proper SEO for the application

     -->

    <meta name="description"
        content="Explore Goa's interactive map featuring detailed cadastral boundaries, land use zones, construction sites, hill slopes, coastal zones (CZMP), and community-contributed locations. 3D terrain views, and regional development plans for comprehensive Goa mapping." />
    <meta name="keywords"
        content="Goa maps, land use zones, cadastral maps, Goa construction sites, Goa coastal zones, CZMP, Survey of India, Goa terrain, Goa RDP, Goa hill slopes, interactive mapping, Goa community mapping, Goa land records" />

    <!-- Progressive Web App Meta Tags -->
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="amche.in">

    <!-- Open Graph Meta Tags for Social Media -->
    <meta property="og:title" content="amche.in - Interactive Map of Goa" />
    <meta property="og:description"
        content="Explore and contribute to the various layers of Goa's community maintained GIS map platform. Layers include cadastral boundaries, land use zones, construction sites, hill slopes, coastal regulation zones (CZMP), regional development plans along with user contributed map annotations." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://amche.in" />
    <meta property="og:image" content="https://amche.in/assets/img/og_image.jpg" />
    <meta property="og:site_name" content="amche.in" />
    <meta property="og:locale" content="en_IN" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="amche.in - Interactive Map of Goa" />
    <meta name="twitter:description"
        content="Explore and contribute to the various layers of Goa's community maintained GIS map platform. Layers include cadastral boundaries, land use zones, construction sites, hill slopes, coastal regulation zones (CZMP), regional development plans along with user contributed map annotations." />
    <meta name="twitter:image" content="https://amche.in/assets/img/og_image.jpg" />

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <!-- Application Scripts -->
    <script src="js/geolocation-control.js"></script>
    <script src="js/mapbox-gl-view-control.js"></script>
    <script type="module" src="js/config-control.js"></script>
    <script type="module" src="js/map-init.js"></script>
    <!-- Service Worker Registration -->
    <script src="js/pwa/register-sw.js"></script>

    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Mapbox GL JS -->
    <link href='https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.css' rel='stylesheet' />
    <script src='https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.js'></script>

    <!-- Mapbox Search JS -->
    <script src="https://api.mapbox.com/search-js/v1.0.0/web.js"></script>

    <!-- Open Sans font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@600&display=swap" rel="stylesheet">

    <!-- Shoelace Components -->
    <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.19.1/cdn/shoelace.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.19.1/cdn/themes/light.css" />

    <link rel="stylesheet" href="styles.css">

    <!-- Add jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- Add this in the head section, before the map-init.js script -->
    <script>
        // Preload default layer styles
        const stylesLink = document.createElement('link');
        stylesLink.rel = 'preload';
        stylesLink.href = 'config/_defaults.json';
        stylesLink.as = 'fetch';
        stylesLink.crossOrigin = 'anonymous';
        document.head.appendChild(stylesLink);
    </script>

</head>

<body class="flex flex-col h-screen">
    <!-- Header -->
    <header class="bg-gray-900 text-white p-4 flex justify-between items-center">
        <div class="flex items-center gap-4">
            <!-- Left Navigation Dropdown -->
            <sl-dropdown>
                <sl-button slot="trigger" variant="text" size="small"
                    class="nav-dropdown-trigger interactive-nav-button">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 00.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z"
                            clip-rule="evenodd" />
                    </svg>
                </sl-button>
                <sl-menu>
                    <sl-menu-label>
                        <a href="https://amche.in"
                            class="text-orange-500 hover:text-orange-400 font-semibold text-lg">amche.in</a>
                    </sl-menu-label>
                    <sl-divider></sl-divider>
                    <sl-menu-item>
                        <svg slot="prefix" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 00.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z"
                                clip-rule="evenodd" />
                        </svg>
                        Maps
                        <sl-menu slot="submenu">
                            <sl-menu-item href="./" class="nav-active">
                                Goa
                            </sl-menu-item>
                            <sl-menu-item href="./?atlas=goa-community">
                                Goa (Community)
                            </sl-menu-item>
                            <sl-menu-item href="./?atlas=goa-historic">
                                Goa (Historic)
                            </sl-menu-item>
                            <sl-menu-item href="./?atlas=mumbai">
                                Mumbai
                            </sl-menu-item>
                            <sl-menu-item href="./?atlas=bombay">
                                Bombay Historical
                            </sl-menu-item>
                            <sl-menu-item href="./?atlas=gurugram">
                                Gurugram
                            </sl-menu-item>
                            <sl-menu-item href="./?atlas=examples/index">
                                Example Template
                            </sl-menu-item>
                            <sl-menu-item href="./?atlas=examples/maphub">
                                World Soil Map
                            </sl-menu-item>
                            <sl-menu-item href="./?atlas=bengaluru-flood">
                                Bengaluru Flood
                            </sl-menu-item>
                        </sl-menu>
                    </sl-menu-item>
                    <sl-menu-item href="./bus/">
                        <svg slot="prefix" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M 202,454 C 197,452 192,447 190,442 C 188,439 188,436 188,420 C 187,408 186,402 186,402 C 185,401 178,401 171,401 L 157,401 L 157,307 L 157,213 L 166,148 C 171,113 176,81 176,78 C 179,71 185,62 192,56 C 198,51 216,42 228,38 C 238,35 257,30 274,27 C 319,19 356,20 404,29 C 458,40 485,54 493,77 C 494,81 498,105 504,149 L 512,214 L 512,308 L 512,401 L 499,401 C 491,401 485,401 484,402 C 484,402 483,408 483,420 C 482,440 481,444 474,450 C 461,461 438,456 433,440 C 433,438 432,429 432,420 C 432,407 432,404 430,402 C 429,401 419,401 335,401 C 251,401 241,401 240,402 C 238,404 238,407 238,421 C 238,436 238,438 236,442 C 233,448 230,451 224,454 C 218,456 207,456 202,454 Z M 221,342 C 231,339 237,330 237,320 C 237,306 227,295 213,295 C 206,295 202,296 197,301 C 191,306 189,311 189,319 C 189,327 191,332 196,337 C 202,343 213,345 221,342 Z M 468,341 C 486,332 486,307 468,298 C 455,291 440,297 434,310 C 432,315 432,325 435,330 C 441,342 456,347 468,341 Z M 470,232 C 473,231 476,230 478,229 C 480,226 482,219 481,214 C 481,213 478,189 474,162 C 467,111 466,107 461,103 C 456,98 458,98 336,98 C 253,98 219,98 215,99 C 210,100 205,105 204,111 C 201,120 188,218 189,222 C 190,227 194,231 199,232 C 206,233 464,233 470,232 Z M 411,76 C 415,75 418,72 419,67 C 419,63 417,58 413,56 C 412,55 389,55 334,55 C 263,55 257,55 255,57 C 251,60 250,66 253,72 C 254,73 256,75 258,75 C 259,76 261,76 262,76 C 264,77 407,77 411,76 Z"/>
                        </svg>
                        Bus
                    </sl-menu-item>
                    <sl-menu-item href="./sound/">
                        <svg slot="prefix" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path
                                d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071a1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243a1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828a1 1 0 010-1.415z" />
                        </svg>
                        Noiselogger
                    </sl-menu-item>
                    <sl-menu-item href="./contact/">
                        <svg slot="prefix" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path
                                d="M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4zM18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z" />
                        </svg>
                        Goa Contact Sheet
                    </sl-menu-item>
                    <sl-divider></sl-divider>
                    <sl-menu-item href="https://github.com/publicmap/amche-goa" target="_blank">
                        <svg slot="prefix" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z"
                                clip-rule="evenodd" />
                        </svg>
                        Source
                    </sl-menu-item>
                    <sl-menu-item href="https://forms.gle/8J4HTJMUM1thWpGK9" target="_blank">
                        <svg slot="prefix" class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z"
                                clip-rule="evenodd" />
                        </svg>
                        Feedback
                    </sl-menu-item>
                </sl-menu>
            </sl-dropdown>

            <div>
                <mapbox-search-box id="search-box"
                    access-token="pk.eyJ1IjoicGxhbmVtYWQiLCJhIjoiY2l3ZmNjNXVzMDAzZzJ0cDV6b2lkOG9odSJ9.eep6sUoBS0eMN4thZUWpyQ"
                    proximity="73.87916,15.26032" country="IN" language="en"
                    types="place,locality,postcode,region,district,street,address,poi">
                </mapbox-search-box>
            </div>
        </div>
        <div class="flex gap-4 items-center">
            <!-- Gear button for Custom Config -->
            <sl-icon-button name="gear" id="load-config-btn" class="config-gear-button"
                title="Custom Config"></sl-icon-button>

            <!-- Share button container for ShareLink plugin -->
            <div id="share-button-container"></div>
        </div>
    </header>

    <!-- Add config dialog -->
    <sl-dialog id="config-dialog" label="Load Custom Configuration">
        <form id="config-form" class="flex flex-col gap-4">
            <sl-input id="config-url" placeholder="Enter configuration URL" required>
                <sl-icon slot="prefix" name="link"></sl-icon>
            </sl-input>
            <p class="text-sm text-gray-600">
                Enter the URL of a JSON configuration file to customize map layers.
                <a href="/config/_defaults.json" target="_blank" class="text-blue-500 hover:underline">View default
                    config</a>
            </p>
            <div class="flex justify-end gap-2">
                <sl-button type="button" variant="default" id="cancel-config">Cancel</sl-button>
                <sl-button type="submit" variant="primary" id="submit-config">Load Configuration</sl-button>
            </div>
        </form>
    </sl-dialog>

    <!-- Add the floating drawer toggle button -->
    <sl-icon-button name="list" id="open-drawer" class="fixed top-20 left-4 z-10 rounded-full shadow-lg"
        style="font-size: 1.5rem; padding: 8px;color:orange"></sl-icon-button>

    <!-- Wrap main content in a container -->
    <div class="flex flex-grow relative h-full">
        <!-- Map Container -->
        <main class="flex-grow relative h-full">
            <div id="map" style="width: 100%; height: 100%;"></div>
            <!-- Add drawer inside the map container -->
            <sl-drawer id="map-controls-drawer" label="Maps à¤¨à¤•à¤¾à¤¸à¥‹" placement="start" class="drawer-placement-start">
                <div slot="label" class="flex items-center gap-2">
                    Maps à¤¨à¤•à¤¾à¤¸à¥‹
                </div>
                <div id="layer-controls-loader" class="p-4">
                    <div class="flex flex-col gap-4" id="skeleton-container"></div>
                </div>
                <div id="layer-controls-container" class="hidden"></div>
            </sl-drawer>

            <div id="edit-mode-control"
                class="mapboxgl-ctrl mapboxgl-ctrl-group absolute bottom-20 right-2 z-10 bg-white rounded shadow-md mr-2">
                <button id="edit-mode-toggle"
                    class="px-2 py-1 text-sm flex items-center justify-center hover:bg-blue-500"
                    title="Toggle Edit Mode">
                    ðŸ“Œ
                </button>
            </div>
        </main>
    </div>

    <!-- Google tag (gtag.js) -->
    <script>
        if (window.location.hostname === 'amche.in') {
            // Load Google Analytics
            const gtagScript = document.createElement('script');
            gtagScript.async = true;
            gtagScript.src = 'https://www.googletagmanager.com/gtag/js?id=G-FBVGZ4HJV0';
            document.head.appendChild(gtagScript);
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-FBVGZ4HJV0');
        }
    </script>
    <script>
        function navigateToSound(event) {
            event.preventDefault();
            const currentHash = window.location.hash;
            const baseUrl = window.location.origin;
            window.location.href = `${baseUrl}/sound/${currentHash}`;
        }
    </script>
    <!-- Modify the drawer initialization script -->
    <script>
        // Initialize drawer functionality after Shoelace components are ready
        customElements.whenDefined('sl-drawer').then(() => {
            const drawer = document.querySelector('.drawer-placement-start');
            const openButton = document.querySelector('#open-drawer');

            // Track if drawer was manually toggled
            let userToggledDrawer = false;

            // Function to handle drawer state based on screen size, respecting user toggles
            function handleDrawerState() {
                // Don't automatically change drawer state if the user manually toggled it
                if (userToggledDrawer) return;

                if (window.innerWidth > 768) { // Desktop
                    drawer.show();
                } else { // Mobile
                    drawer.hide();
                }
            }

            // Initial state
            handleDrawerState();

            // Listen for window resize, but don't apply on touch devices
            const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            if (!isTouch) {
                window.addEventListener('resize', handleDrawerState);
            }

            // Toggle drawer when button is clicked
            openButton.addEventListener('click', () => {
                userToggledDrawer = true;
                drawer.show();
            });

            // Listen for drawer close event
            drawer.addEventListener('sl-hide', () => {
                userToggledDrawer = true;
            });
        });

        // Initialize custom configuration dialog
        customElements.whenDefined('sl-dialog').then(() => {
            const configDialog = document.getElementById('config-dialog');
            const loadConfigBtn = document.getElementById('load-config-btn');
            const cancelConfigBtn = document.getElementById('cancel-config');
            const configForm = document.getElementById('config-form');

            loadConfigBtn.addEventListener('click', (event) => {
                event.preventDefault();
                configDialog.show();
            });

            cancelConfigBtn.addEventListener('click', () => {
                configDialog.hide();
            });

            configForm.addEventListener('submit', (event) => {
                event.preventDefault();
                const configUrl = document.getElementById('config-url').value;
                if (configUrl) {
                    const currentUrl = new URL(window.location.href);
                    currentUrl.searchParams.set('config', configUrl);
                    window.location.href = currentUrl.toString();
                }
            });
        });

        // Handle navigation dropdown menu clicks
        customElements.whenDefined('sl-menu-item').then(() => {
            document.querySelectorAll('sl-menu-item[href]').forEach(item => {
                item.addEventListener('click', (event) => {
                    const href = item.getAttribute('href');
                    if (href && href.startsWith('http')) {
                        // External links - open in new tab if target="_blank"
                        if (item.getAttribute('target') === '_blank') {
                            event.preventDefault();
                            window.open(href, '_blank');
                        }
                    } else if (href) {
                        // Internal navigation
                        if (!item.hasAttribute('onclick')) {
                            event.preventDefault();
                            window.location.href = href;
                        }
                    }
                });
            });
        });
    </script>
    <script>
        // Add this after your existing scripts
        const skeletonContainer = document.getElementById('skeleton-container');
        const numberOfSkeletons = 15;

        Array.from({ length: numberOfSkeletons }).forEach(() => {
            const skeleton = document.createElement('sl-skeleton');
            skeleton.className = 'skeleton-map-controls';
            skeleton.setAttribute('effect', 'pulse');
            skeletonContainer.appendChild(skeleton);
        });
    </script>

    <!-- ShareLink plugin initialization -->
    <script type="module">
        import { ShareLink } from './js/share-link.js';

        // Initialize ShareLink plugin when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            const shareLink = new ShareLink({
                containerId: 'share-button-container',
                url: () => window.location.href, // Dynamic URL function
                buttonText: 'Share à¤µà¤¾à¤‚à¤Ÿà¥‹',
                buttonClasses: 'share-button',
                showToast: true,
                qrCodeSize: 500
            });

            shareLink.render();
        });
    </script>
</body>

</html>